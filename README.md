# AtomicThreatProfile
AtomicThreatProfile is a Python script that creates custom adversary profiles for use in Caldera using json formatted data generated from Control Validation Compass.
Caldera is a cyber security framework designed to easily run autonomous breach-and-simulation exercises, this tool provides great funtionality depending on the use case. However, when using this tool I realised that creating custom adversay profiles can be tedious and saw an oppurtuntity to enhance Caldera by automating profile creation 
underpinned by threat intelligence provided by Control Validation Compass.

# Requirements
- Linux 
- Python 3.8+
- Caldera (https://github.com/mitre/caldera)

# Installation 
`git clone https://github.com/NerdChip/AtomicThreatProfile`  
`cd AtomicThreatProfile`  
`pip3 install -r requirements.txt` 

# Usage 
Before executing Atomic threat profile you will need to retrieve data generated by Control Validation Comapass(CVC). CVC is a great resource that has a number of uses but AtomicThreatProfile only uterlises the Threat Model feature which can be used to categrise potential threats based on motive, location and industy(https://controlcompass.github.io/). This data is what will be passed to AtomicThreatProfile to produce the custom adversary profile within Caldera.

## Select Threat Group
Fill in the one or multiple critera and select a single adversary on the right hand side. For the purpose of this example i have choosen Lazarus Group. 

![image](https://user-images.githubusercontent.com/67340007/221676871-380ff4d6-dd67-4dee-acba-c11cb61f8bbd.png)

## Copy json Data
After you have chosen an adversary scroll down the page and you will see, Adversary Profile, ATT&CK Navigator Layer (TTPs) and Diamond Model. we will be using the ATT&CK Navigator json data to create the custom adversary profile, click inside the the box and copy the data (ctrl-a & ctrl-c).  

![image](https://user-images.githubusercontent.com/67340007/221678087-59d4fa46-ba5d-43b8-84c3-3a3ec3da52e7.png)

## Generate json File 
Once the data has been copied it will be pasted inside a new json file create on the system where Caldera and AtomicThreatProfile are inlsalled. Please remember to create the file in the same working directory as AtomicThreatProfile - Another tip would be to make sure the filename resembles that of the selected threat group. Dont forget to elevate to root priveleges. 

`nano LazarusGroup.json`

![image](https://user-images.githubusercontent.com/67340007/221679704-61bb726a-0b34-4004-8755-dc7839266d2e.png)

## AtomicThreatProfile 
Use -h to invoke help 

`python3 AtomicThreatProfile.py -h`

![image](https://user-images.githubusercontent.com/67340007/221681397-08b1e5a8-632e-4b53-b678-ea3959aeec15.png)

To run AtomicThreatProfile you will need to pass the prevously create json file (-f) and the threat group name (-t), these areguments are required. You can also specify which operating system you want the techniques to be related to (-p) at the moment only windows is supported, this arguement is optional and the default is "all". 

`python3 AtomicThreatProfile.py -f LazarusGroup.json -t LazarusGroup`  
`python3 AtomicThreatProfile.py -f LazarusGroup.json -t LazarusGroup -p windows`

![image](https://user-images.githubusercontent.com/67340007/221683374-b6be1aff-5e8c-4e72-8c91-942645a26ed0.png)

Once the program has completed some check the user will be prompted to select which techniques they want to include within the custom adversary profile, to select a technique you use **space bar** to confirm selection use **Enter** (you can select multiple under 1 technique)if a mistake is made during this process you will have to re-execute the program. please remember that these profiles will only be generated based on the techniques that Caldera has within its framework. 

![image](https://user-images.githubusercontent.com/67340007/221684638-6082807a-aae8-4c24-aa57-12a151fda733.png)

